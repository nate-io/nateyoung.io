---
import { getCollection, getEntry } from "astro:content"
import BaseLayout from "../../layouts/BaseLayout.astro"
import PageContentWrapper from "../../components/PageContentWrapper.astro"

export async function getStaticPaths() {
  const blogEntries = await getCollection("blog")
  return blogEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }))
}

const { entry } = Astro.props
const { Content } = await entry.render()

// Format the publication date
const formattedDate = entry.data.pubDate.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
})
---

<BaseLayout
  title={`${entry.data.title} | Nate Young`}
  description={entry.data.description}
>
  <PageContentWrapper>
    <article class='py-12 max-w-3xl mx-auto'>
      <header class='mb-8'>
        <h1 class='text-4xl font-bold mb-4'>{entry.data.title}</h1>
        <div class='flex items-center text-light-gray mb-6'>
          <span>{formattedDate}</span>
          <span class='mx-2'>•</span>
          <span>{entry.data.author}</span>
        </div>
        {
          entry.data.tags && (
            <div class='flex flex-wrap gap-2 mb-6'>
              {entry.data.tags.map((tag) => (
                <span class='text-xs bg-medium-gray text-white px-2 py-1 rounded'>
                  {tag}
                </span>
              ))}
            </div>
          )
        }
        <p class='text-light-gray text-xl'>{entry.data.description}</p>
      </header>

      <div
        class='prose prose-invert max-w-none prose-headings:text-white prose-headings:font-bold prose-h1:text-3xl prose-h2:text-2xl prose-p:text-light-gray prose-a:text-highlight-blue'
      >
        <Content />
      </div>

      <div class='mt-12 pt-8 border-t border-dark-gray'>
        <a href='/blog' class='text-highlight-blue hover:underline'>
          ← Back to all posts
        </a>
      </div>
    </article>
  </PageContentWrapper>
</BaseLayout>

<style is:global>
  .prose h1 {
    margin-top: 2.5rem;
    margin-bottom: 1.5rem;
  }
  .prose h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
  }
  .prose p {
    margin-bottom: 1.5rem;
    line-height: 1.75;
  }
  .prose ul,
  .prose ol {
    margin-left: 1.5rem;
    margin-bottom: 1.5rem;
  }
  .prose li {
    margin-bottom: 0.5rem;
    color: var(--color-light-gray);
  }
  .prose code {
    background-color: var(--color-dark-gray);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-family: "Fira Code", monospace;
    font-size: 0.9em;
  }
  .prose pre {
    background-color: var(--color-dark-gray);
    padding: 1rem;
    border-radius: 5px;
    overflow-x: auto;
    margin-bottom: 1.5rem;
  }
</style>
